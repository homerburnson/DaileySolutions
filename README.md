# Node OpenAI App

This is a full-stack Node.js application that integrates with OpenAI's API to generate dynamic responses based on user input. The project includes a backend powered by Express.js and a frontend built with vanilla JavaScript and HTML. It incorporates a Qdrant database (best in benchmarking tests for performance) and uses a **Retrieval-Augmented Generation (RAG)** model to enhance responses with relevant context.

---

## Overview

- **Backend**: Manages API requests, file uploads, and communication with OpenAI.
- **Frontend**: Provides a user interface for querying the AI, uploading files, and interacting with the app.
- **Use Case**: Designed to showcase CVs, cover letters, and job application materials, with the ability to query OpenAI and manage content.

---

## Project Structure

```
node-openai-app
├── backend
│   ├── texts/                # Uploaded files: CVs, cover letters, job descriptions, and more
│   │   ├── bio/              # Biography files (e.g., bio.txt)
│   │   ├── covers/           # Cover letter files (e.g., Standard cover letter)
│   │   ├── cv/               # CV files (e.g., Standard CV)
│   │   ├── company/          # Company-specific files
│   │   ├── jobs/             # Job description files
│   │   └── user/             # User-specific files
│   ├── routes/               # Express route handlers
│   │   ├── api.js            # Handles OpenAI API requests and Qdrant interactions
│   │   └── upload.js         # Handles file uploads and management
│   ├── server.js             # Express server entry point
│   └── logger.js             # Centralized logging configuration
├── frontend
│   ├── public/               # Public assets and frontend logic
│   │   ├── index.html        # Main frontend UI
│   │   ├── upload.html       # Upload and file management page
│   │   ├── App.js            # Frontend JavaScript logic
│   │   ├── styles/           # CSS styling
│   │   │   └── App.css       # Main stylesheet
│   │   ├── images/           # Static assets
│   │   │   ├── profile.jpg   # Profile image
│   │   │   ├── background.png # Background image for the UI
│   │   │   └── background2.png # Background image for dark mode
│   │   └── favicon.ico       # Favicon for the app
│   └── views/                # EJS templates for dynamic rendering
│       ├── index.ejs         # Main page template
│       └── upload.ejs        # Upload page template
├── package.json              # Combined dependencies and scripts for the entire project
├── .env                      # Environment variables for the project
├── README.md                 # Project documentation
├── .env.example              # Example environment variables
└── .gitignore                # Git ignore file
```

---

## Getting Started

### Requirements

- Node.js (v14 or newer)
- npm (Node package manager)

### Installation

1. Clone the repository:
   ```bash
   git clone <repository-url>
   cd node-openai-app
   ```

2. Install dependencies:
   ```bash
   npm install
   ```

3. Set up the `.env` file:
   - Copy the `.env.example` file to `.env`:
     ```bash
     cp .env.example .env
     ```
   - Update the `.env` file with your configuration:
     - `OPENAI_API_KEY`: Your OpenAI API key.
     - `CLUSTERURL`: Your Qdrant cluster URL.
     - `DBSECRET`: Your Qdrant API key.
     - `NAME`, `TITLE`, `BRAND`, `LOCATION`: User-specific details.

---

## Running the App

1. Start the backend server:
   ```bash
   npm start
   ```

2. Open the frontend:
   - Open `http://localhost:3000` in your browser.

---

## Features

- **Retrieval-Augmented Generation (RAG)**: Combines OpenAI's generative capabilities with relevant context retrieved from a vector database (Qdrant). This ensures responses are accurate, context-aware, and tailored to the user's query.
- **Query OpenAI**: Enter a prompt and receive a response generated by the OpenAI model.
- **Dynamic Context**: The app dynamically includes CV, cover letter, and job description text files in the OpenAI context window based on a keyword.
- **Download CV**: A button allows users to download the CV from the `cv_public` folder.
- **File Upload**: Upload `.txt` files to specific folders (`bio`, `covers`, `cv`, `jobs`, `company`, `user`) via the `/uploaddocs` page.
- **File Management**: View, edit, and delete uploaded files directly from the `/uploaddocs` page.
- **Embedding Generation**: Generate sets of embeddings for uploaded files using OpenAI's embedding model and store them in the Qdrant vector database.
- **Dynamic Context Loading**: Dynamically loads relevant files into the OpenAI context based on a keyword passed as a Base64-encoded query parameter.
- **Session History**: Maintains a conversation history for each session, allowing OpenAI to respond with context-aware answers.

---

## Technical Implementation

To set up the app, you need accounts for **OpenAI**, **Qdrant**, and **Auth0**. Follow the steps below to configure these platforms and generate the required keys.

### **1. OpenAI Setup**
1. Create an account on [OpenAI](https://platform.openai.com/).
2. Navigate to the **API Keys** section in your OpenAI dashboard.
3. Generate a new API key and copy it.
4. Add the key to the `.env` file:
   ```env
   OPENAI_API_KEY=your-openai-api-key
   ```

### **2. Qdrant Setup**
1. Create an account on [Qdrant Cloud](https://cloud.qdrant.io/) or set up a self-hosted Qdrant instance.
2. If using Qdrant Cloud:
   - Create a new cluster and note the **Cluster URL**.
   - Generate an API key for authentication.
3. If self-hosting:
   - Install Qdrant using Docker or another method.
   - Use `http://localhost:6333` as the cluster URL.
4. Add the cluster URL and API key to the `.env` file:
   ```env
   CLUSTERURL=your-qdrant-cluster-url
   DBSECRET=your-qdrant-api-key
   QDRANT_COLLECTION_NAME=document_embeddings
   ```

### **3. Auth0 Setup**
1. Create an account on [Auth0](https://auth0.com/).
2. Create a new application in the Auth0 dashboard:
   - Choose the **Regular Web Application** type.
3. Note the **Domain**, **Client ID**, and **Client Secret**.
4. Configure the callback URL in the Auth0 dashboard:
   - Set the callback URL to `http://localhost:3000/callback` (or your production URL).
5. Add the Auth0 credentials to the `.env` file:
   ```env
   AUTH0_DOMAIN=your-auth0-domain
   AUTH0_CLIENT_ID=your-auth0-client-id
   AUTH0_CLIENT_SECRET=your-auth0-client-secret
   ```

---

## License

This project is licensed under the MIT License.